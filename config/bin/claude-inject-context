#!/bin/bash
# Inject dynamic context into Claude Code sessions via SessionStart hook.
# Outputs context to stdout, which Claude Code includes in the session.

set -euo pipefail

contexts_dir="${HOME}/.claude/contexts"

# Load static context files
for f in "${contexts_dir}"/*.md; do
  [ -f "$f" ] && cat "$f"
done 2> /dev/null

# Conditional context based on repository characteristics
remote=$(git remote get-url origin 2> /dev/null || true)

if [[ "$remote" == *"github.com/fohte/"* || "$remote" == *"github.com:fohte/"* ]]; then
  cat << 'EOF'

## fohte organization context

- Gemini Code Assist is enabled for CI reviews
- Use `a ai review wait` after PR creation to wait for Gemini review
- Use `check-pr-review` skill to address review feedback
EOF
fi
