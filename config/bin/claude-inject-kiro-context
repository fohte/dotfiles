#!/bin/bash
# Inject Kiro context for Claude Code SessionStart hook
# Outputs content if .claude/commands/kiro/ exists (specs repo) or .kiro exists (legacy)

set -euo pipefail

# Check if kiro commands exist in current directory (specs repo)
if [[ -d .claude/commands/kiro ]]; then
  cat ~/.claude/contexts/kiro.md
  exit 0
fi

# Legacy: Check if .kiro directory exists in current directory
if [[ ! -d .kiro ]]; then
  exit 0
fi

# Check if this is a fohte org repository
remote_url=$(git remote get-url origin 2> /dev/null || echo "")
if [[ ! "$remote_url" =~ github\.com[:/]fohte/ ]]; then
  exit 0
fi

# Output the Kiro context
cat ~/.claude/contexts/kiro.md
