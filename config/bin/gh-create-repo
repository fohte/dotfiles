#!/usr/bin/env bash

set -euo pipefail

repo_visibility="private"

while [[ $# -gt 0 ]]; do
  case "$1" in
    --public)
      repo_visibility="public"
      shift
      ;;
    --private)
      repo_visibility="private"
      shift
      ;;
    --internal)
      repo_visibility="internal"
      shift
      ;;
    -*)
      echo "Unknown option: $1"
      exit 1
      ;;
    *)
      break
      ;;
  esac
done

repo="$1"
shift

ghq create "$repo"

cd "$(ghq root)/$(ghq list "$repo" --full-path)"

gh repo create "$repo" "--$repo_visibility" --source=.

git commit --allow-empty -m "initial commit"
git push -u
